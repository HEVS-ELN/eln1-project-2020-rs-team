Version 4
SHEET 1 5500 1592
WIRE 3168 -368 2304 -368
WIRE 3184 -368 3168 -368
WIRE 2160 -160 2128 -160
WIRE 2304 -160 2304 -368
WIRE 2304 -160 2240 -160
WIRE 2912 -144 2880 -144
WIRE 3072 -144 2992 -144
WIRE 1840 -48 1744 -48
WIRE 2016 -48 1904 -48
WIRE 2128 -48 2128 -160
WIRE 2128 -48 2096 -48
WIRE 2192 -48 2128 -48
WIRE 2304 -32 2304 -160
WIRE 2304 -32 2256 -32
WIRE 2336 -32 2304 -32
WIRE 2512 -32 2416 -32
WIRE 2656 -32 2512 -32
WIRE 2752 -32 2656 -32
WIRE 2880 -32 2880 -144
WIRE 2880 -32 2832 -32
WIRE 2944 -32 2880 -32
WIRE 2192 -16 2144 -16
WIRE 3072 -16 3072 -144
WIRE 3072 -16 3008 -16
WIRE 3168 -16 3072 -16
WIRE 3184 -16 3168 -16
WIRE 2944 0 2896 0
WIRE 1744 32 1744 -48
WIRE 2512 48 2512 -32
WIRE 2656 48 2656 -32
WIRE 2144 64 2144 -16
WIRE 2896 80 2896 0
WIRE 1744 160 1744 112
WIRE 2512 160 2512 128
WIRE 2512 160 1744 160
WIRE 2656 160 2656 112
WIRE 2656 160 2512 160
WIRE 2656 176 2656 160
WIRE 160 256 -128 256
WIRE 384 256 240 256
WIRE 528 256 384 256
WIRE -128 304 -128 256
WIRE 384 336 384 256
WIRE 528 336 528 256
WIRE -128 448 -128 384
WIRE 384 448 384 416
WIRE 384 448 -128 448
WIRE 528 448 528 400
WIRE 528 448 384 448
WIRE 528 464 528 448
WIRE 2192 784 2160 784
WIRE 2352 784 2272 784
WIRE 2928 800 2896 800
WIRE 3088 800 3008 800
WIRE 96 832 -192 832
WIRE 320 832 176 832
WIRE 464 832 320 832
WIRE -192 880 -192 832
WIRE 1872 896 1760 896
WIRE 2048 896 1936 896
WIRE 2160 896 2160 784
WIRE 2160 896 2128 896
WIRE 2224 896 2160 896
WIRE 320 912 320 832
WIRE 464 912 464 832
WIRE 1312 912 1312 880
WIRE 1312 912 1280 912
WIRE 2352 912 2352 784
WIRE 2352 912 2288 912
WIRE 2368 912 2352 912
WIRE 2528 912 2448 912
WIRE 2672 912 2528 912
WIRE 2768 912 2672 912
WIRE 2896 912 2896 800
WIRE 2896 912 2848 912
WIRE 2960 912 2896 912
WIRE 2224 928 2176 928
WIRE 3088 928 3088 800
WIRE 3088 928 3024 928
WIRE 3200 928 3088 928
WIRE 3248 928 3200 928
WIRE 1312 944 1312 912
WIRE 2960 944 2912 944
WIRE 1760 960 1760 896
WIRE 2528 992 2528 912
WIRE 2672 992 2672 912
WIRE 2176 1008 2176 928
WIRE -192 1024 -192 960
WIRE 320 1024 320 992
WIRE 320 1024 -192 1024
WIRE 464 1024 464 976
WIRE 464 1024 320 1024
WIRE 2912 1024 2912 944
WIRE 464 1040 464 1024
WIRE 1760 1104 1760 1040
WIRE 2528 1104 2528 1072
WIRE 2528 1104 1760 1104
WIRE 2672 1104 2672 1056
WIRE 2672 1104 2528 1104
WIRE 2672 1120 2672 1104
WIRE 96 1136 -192 1136
WIRE 320 1136 176 1136
WIRE 464 1136 320 1136
WIRE -192 1184 -192 1136
WIRE 320 1216 320 1136
WIRE 464 1216 464 1136
WIRE -192 1328 -192 1264
WIRE 320 1328 320 1296
WIRE 320 1328 -192 1328
WIRE 464 1328 464 1280
WIRE 464 1328 320 1328
WIRE 464 1344 464 1328
FLAG 2672 1120 0
FLAG 1280 912 0
FLAG 1312 800 Vcc
FLAG 1312 1024 Vee
FLAG 528 464 0
FLAG 2656 176 0
FLAG 464 1040 0
FLAG 464 1344 0
FLAG 2672 912 Vout
FLAG 2256 944 Vee
FLAG 2256 880 Vcc
FLAG 2176 1008 0
FLAG 2224 0 Vee
FLAG 2224 -64 Vcc
FLAG 2144 64 0
FLAG 2992 960 Vee
FLAG 2992 896 Vcc
FLAG 2912 1024 0
FLAG 3200 928 Vmeas
FLAG 2352 784 Vatten
FLAG 2976 16 Vee
FLAG 2976 -48 Vcc
FLAG 2896 80 0
FLAG 2656 -32 Vout3
FLAG 2304 -160 Vatten3
FLAG 3168 -368 Van1
FLAG 3168 -16 Van2
SYMBOL res 2464 896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {R}
SYMBOL res 2544 1088 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rpr
SYMATTR Value 1Meg
SYMBOL cap 2656 992 R0
SYMATTR InstName Cpr
SYMATTR Value 61.9pF
SYMBOL voltage 1312 784 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {Vbatt-Vref}
SYMBOL voltage 1312 928 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value {Vref}
SYMBOL res 256 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {R}
SYMBOL res 400 432 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rpr1
SYMATTR Value 266k
SYMBOL cap 512 336 R0
SYMATTR InstName Cpr1
SYMATTR Value 2.43nF
SYMBOL voltage -128 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -425 114 Left 2
SYMATTR Value PULSE({-Vref} {Vbatt-Vref} 0 1u 1u {1/(2*freq)} {1/freq})
SYMATTR InstName V4
SYMBOL voltage 1760 944 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -430 121 Left 2
SYMATTR Value PULSE({-Vref} {Vbatt-Vref} 0 1u 1u {1/(2*freq)} {1/freq})
SYMATTR InstName V1
SYMBOL res 2432 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {R}
SYMBOL res 2528 144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rpr2
SYMATTR Value 10k
SYMBOL cap 2640 48 R0
SYMATTR InstName Cpr2
SYMATTR Value 4.79nF
SYMBOL voltage 1744 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -719 105 Left 2
SYMATTR Value PULSE({-Vref} {Vbatt-Vref} 0 1u 1u {1/(2*freq)} {1/freq})
SYMATTR InstName V5
SYMBOL res 192 816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {R}
SYMBOL res 336 1008 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rpr3
SYMATTR Value 6.5k
SYMBOL cap 448 912 R0
SYMATTR InstName Cpr3
SYMATTR Value 8.76nF
SYMBOL voltage -192 864 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -425 114 Left 2
SYMATTR Value PULSE({-Vref} {Vbatt-Vref} 0 1u 1u {1/(2*freq)} {1/freq})
SYMATTR InstName V6
SYMBOL res 336 1312 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rpr4
SYMATTR Value 750
SYMBOL cap 448 1216 R0
SYMATTR InstName Cpr4
SYMATTR Value 58.8nF
SYMBOL voltage -192 1168 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -425 114 Left 2
SYMATTR Value PULSE({-Vref} {Vbatt-Vref} 0 1u 1u {1/(2*freq)} {1/freq})
SYMATTR InstName V7
SYMBOL res 192 1120 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {R}
SYMBOL Opamps\\UniversalOpamp2 2256 912 R0
SYMATTR InstName U2
SYMATTR Value2 Avol=1Meg GBW=14k Slew=3.5Meg
SYMBOL res 2288 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 2144 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 510k
SYMBOL Opamps\\UniversalOpamp2 2224 -32 R0
SYMATTR InstName U1
SYMATTR Value2 Avol=1Meg GBW=14k Slew=3.5Meg
SYMATTR SpiceLine ilimit=25m rail=0 Vos=2m phimargin=45
SYMBOL res 2256 -176 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100k
SYMBOL res 2112 -64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 510k
SYMBOL Opamps\\UniversalOpamp2 2992 928 R0
SYMATTR InstName U3
SYMATTR Value2 Avol=1Meg GBW=14k Slew=3.5Meg
SYMBOL res 3024 784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 200k
SYMBOL res 2864 896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL Opamps\\UniversalOpamp2 2976 -16 R0
SYMATTR InstName U4
SYMATTR Value2 Avol=1Meg GBW=14k Slew=3.5Meg
SYMBOL res 3008 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 200k
SYMBOL res 2848 -48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 100k
SYMBOL cap 1904 -64 R90
WINDOW 0 -12 29 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 33nF
SYMBOL cap 1936 880 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 33nF
TEXT 1288 648 Left 2 !.params freq=2k Vbatt=3 R=10k R1=5k Vref=1.25
TEXT 1296 704 Left 2 !.tran 0 110m 10m 1u
